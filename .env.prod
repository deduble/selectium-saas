# =============================================================================
# Selextract Cloud Production Environment Configuration
# =============================================================================
#
# IMPORTANT SECURITY NOTES:
# 1. Generate strong, unique passwords for all services
# 2. Use secure random values for all secret keys
# 3. Replace placeholder values with actual production credentials
# 4. Restrict file permissions: chmod 600 .env.prod
# 5. Never commit this file to version control
#
# =============================================================================

# =============================================================================
# DOCKER COMPOSE PROJECT CONFIGURATION
# =============================================================================
# Standardizes container naming across all environments
COMPOSE_PROJECT_NAME=selectium-saas

# =============================================================================
# ENVIRONMENT SETTINGS
# =============================================================================
ENVIRONMENT=production
DEBUG=false
NODE_ENV=production

# Application URLs (Update with your actual domains)
API_URL=https://api.selextract.com
FRONTEND_URL=https://app.selextract.com
ALLOWED_ORIGINS=https://app.selextract.com,https://selextract.com

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# PostgreSQL Database Settings
POSTGRES_DB=selextract
POSTGRES_USER=postgres
POSTGRES_PASSWORD=REPLACE_WITH_STRONG_PASSWORD_32_CHARS_MIN

# Database Connection URL (automatically constructed)
DATABASE_URL=postgresql://postgres:${POSTGRES_PASSWORD}@postgres:5432/selextract

# Database Performance Settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================
# Redis Settings
REDIS_PASSWORD=REPLACE_WITH_STRONG_REDIS_PASSWORD_32_CHARS
REDIS_URL=redis://:${REDIS_PASSWORD}@redis:6379/0

# Redis Performance Settings
REDIS_MAX_CONNECTIONS=50
REDIS_RETRY_ON_TIMEOUT=true
REDIS_SOCKET_KEEPALIVE=true

# =============================================================================
# AUTHENTICATION & SECURITY
# =============================================================================
# JWT Configuration
JWT_SECRET_KEY=REPLACE_WITH_STRONG_JWT_SECRET_64_CHARS_MINIMUM
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# NextAuth Configuration
NEXTAUTH_SECRET=REPLACE_WITH_STRONG_NEXTAUTH_SECRET_64_CHARS
NEXTAUTH_URL=https://app.selextract.com

# Session Security
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=strict

# =============================================================================
# OAUTH PROVIDERS
# =============================================================================
# Google OAuth (Replace with actual credentials)
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=REPLACE_WITH_ACTUAL_GOOGLE_CLIENT_SECRET

# GitHub OAuth (Optional - Replace with actual credentials)
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=REPLACE_WITH_ACTUAL_GITHUB_CLIENT_SECRET

# =============================================================================
# EXTERNAL API KEYS
# =============================================================================
# Webshare.io Proxy Service (Required for scraping)
WEBSHARE_API_KEY=REPLACE_WITH_ACTUAL_WEBSHARE_API_KEY

# Lemon Squeezy Billing Configuration (Replace with actual values)
LEMON_SQUEEZY_API_KEY=REPLACE_WITH_ACTUAL_LEMON_SQUEEZY_API_KEY
LEMON_SQUEEZY_STORE_ID=your-actual-store-id
LEMON_SQUEEZY_WEBHOOK_SECRET=REPLACE_WITH_ACTUAL_WEBHOOK_SECRET
LEMON_SQUEEZY_BASE_URL=https://api.lemonsqueezy.com/v1
LEMON_SQUEEZY_WEBHOOK_URL=https://api.selextract.com/api/billing/webhooks/lemon-squeezy

# Lemon Squeezy Product Variant IDs (Update with actual IDs from dashboard)
LEMON_SQUEEZY_STARTER_VARIANT_ID=replace-with-starter-variant-id
LEMON_SQUEEZY_PROFESSIONAL_VARIANT_ID=replace-with-professional-variant-id
LEMON_SQUEEZY_ENTERPRISE_VARIANT_ID=replace-with-enterprise-variant-id

# =============================================================================
# BILLING CONFIGURATION
# =============================================================================
BILLING_CURRENCY=USD
BILLING_TAX_RATE=0.0
BILLING_TRIAL_PERIOD_DAYS=0
COMPUTE_UNITS_OVERAGE_RATE_CENTS=5
MAX_COMPUTE_UNITS_OVERAGE_PERCENT=50

# =============================================================================
# WORKER CONFIGURATION
# =============================================================================
# Celery Configuration
CELERY_BROKER_URL=${REDIS_URL}
CELERY_RESULT_BACKEND=${REDIS_URL}
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=json
CELERY_TIMEZONE=UTC
CELERY_ENABLE_UTC=true

# Worker Performance Settings
CELERY_WORKER_CONCURRENCY=4
CELERY_WORKER_PREFETCH_MULTIPLIER=1
CELERY_TASK_SOFT_TIME_LIMIT=600
CELERY_TASK_TIME_LIMIT=900
CELERY_TASK_MAX_RETRIES=3

# =============================================================================
# MONITORING CONFIGURATION
# =============================================================================
# Grafana Configuration
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=REPLACE_WITH_STRONG_GRAFANA_PASSWORD

# Prometheus Configuration
PROMETHEUS_RETENTION_TIME=30d
PROMETHEUS_STORAGE_RETENTION_SIZE=10GB

# =============================================================================
# ALERTING CONFIGURATION
# =============================================================================
# Email Configuration for Alerts
ADMIN_EMAIL=admin@selextract.com
BUSINESS_EMAIL=business@selextract.com
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=alerts@selextract.com
SMTP_PASSWORD=REPLACE_WITH_ACTUAL_SMTP_PASSWORD
SMTP_USE_TLS=true

# Alertmanager Webhook Authentication
ALERTMANAGER_WEBHOOK_PASSWORD=REPLACE_WITH_STRONG_WEBHOOK_PASSWORD

# Slack Integration (Optional)
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK

# =============================================================================
# BACKUP CONFIGURATION
# =============================================================================
# Backup Settings
BACKUP_DIR=/opt/backups
BACKUP_RETENTION_DAYS=30
REMOTE_BACKUP_ENABLED=true

# AWS S3 Backup (Optional - uncomment and configure if using)
# AWS_ACCESS_KEY_ID=your-aws-access-key
# AWS_SECRET_ACCESS_KEY=your-aws-secret-key
# AWS_S3_BUCKET=selextract-backups
# AWS_S3_REGION=us-east-1

# Backblaze B2 Backup (Optional - uncomment and configure if using)
# B2_APPLICATION_KEY_ID=your-b2-key-id
# B2_APPLICATION_KEY=your-b2-application-key
# BACKBLAZE_BUCKET=selextract-backups

# Rsync Backup (Optional - uncomment and configure if using)
# RSYNC_DESTINATION=user@backup-server:/path/to/backups

# =============================================================================
# PERFORMANCE CONFIGURATION
# =============================================================================
# API Performance Settings
API_WORKERS=4
API_MAX_REQUESTS=1000
API_MAX_REQUESTS_JITTER=50
API_TIMEOUT=30
API_KEEPALIVE=2

# Frontend Performance Settings
NEXT_TELEMETRY_DISABLED=1
NEXT_OPTIMIZE_FONTS=true
NEXT_OPTIMIZE_IMAGES=true

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
# Log Levels
LOG_LEVEL=INFO
API_LOG_LEVEL=INFO
WORKER_LOG_LEVEL=INFO
NGINX_LOG_LEVEL=warn

# Log Formats
LOG_FORMAT=json
LOG_TIMESTAMP=true

# Log File Settings
LOG_MAX_SIZE=100MB
LOG_BACKUP_COUNT=5
LOG_ROTATION=daily

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================
# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_BURST=10

# CORS Settings
CORS_ALLOW_CREDENTIALS=true
CORS_MAX_AGE=86400

# Security Headers
SECURITY_HEADERS_ENABLED=true
HSTS_MAX_AGE=31536000
CSP_ENABLED=true

# =============================================================================
# SSL/TLS CONFIGURATION
# =============================================================================
# SSL Settings
SSL_CERT_PATH=/etc/nginx/ssl/selextract.com/fullchain.pem
SSL_KEY_PATH=/etc/nginx/ssl/selextract.com/privkey.pem
SSL_CHAIN_PATH=/etc/nginx/ssl/selextract.com/chain.pem

# Let's Encrypt Settings
LETSENCRYPT_EMAIL=${ADMIN_EMAIL}
LETSENCRYPT_STAGING=false

# =============================================================================
# RESOURCE LIMITS
# =============================================================================
# Memory Limits (for Docker containers)
POSTGRES_MEMORY_LIMIT=16G
REDIS_MEMORY_LIMIT=4G
API_MEMORY_LIMIT=8G
WORKER_MEMORY_LIMIT=4G
FRONTEND_MEMORY_LIMIT=4G
NGINX_MEMORY_LIMIT=1G
PROMETHEUS_MEMORY_LIMIT=2G
GRAFANA_MEMORY_LIMIT=2G

# CPU Limits
POSTGRES_CPU_LIMIT=4
REDIS_CPU_LIMIT=2
API_CPU_LIMIT=4
WORKER_CPU_LIMIT=2
FRONTEND_CPU_LIMIT=2
NGINX_CPU_LIMIT=1
PROMETHEUS_CPU_LIMIT=1
GRAFANA_CPU_LIMIT=1

# =============================================================================
# DEPLOYMENT CONFIGURATION
# =============================================================================
# Deployment Settings
DEPLOY_USER=deploy
UPDATE_STRATEGY=rolling
HEALTH_CHECK_TIMEOUT=30
HEALTH_CHECK_RETRIES=3

# Maintenance Settings
MAINTENANCE_MODE=false
MAINTENANCE_MESSAGE="Selextract is under maintenance. We'll be back shortly!"

# =============================================================================
# FEATURE FLAGS
# =============================================================================
# Feature Toggles
FEATURE_USER_REGISTRATION=true
FEATURE_GUEST_ACCESS=false
FEATURE_API_RATE_LIMITING=true
FEATURE_ADVANCED_MONITORING=true
FEATURE_AUTO_SCALING=false

# =============================================================================
# CUSTOM APPLICATION SETTINGS
# =============================================================================
# Business Logic Settings
DEFAULT_COMPUTE_UNITS=1000
MAX_CONCURRENT_TASKS_FREE=2
MAX_CONCURRENT_TASKS_PAID=10
TASK_TIMEOUT_SECONDS=1800
MAX_RESULT_SIZE_MB=100

# Scraping Settings
DEFAULT_USER_AGENT="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"
MAX_PAGES_PER_TASK=100
PROXY_ROTATION_ENABLED=true
RESPECT_ROBOTS_TXT=true

# =============================================================================
# DEVELOPMENT OVERRIDES (Remove in production)
# =============================================================================
# These should be commented out or removed in production
# DEV_MODE=false
# SKIP_AUTH=false
# MOCK_EXTERNAL_APIS=false

# =============================================================================
# END OF CONFIGURATION
# =============================================================================
#
# Security Checklist Before Deployment:
# [ ] All placeholder values replaced with actual credentials
# [ ] Strong passwords generated (32+ characters)
# [ ] SSL certificates obtained and configured
# [ ] DNS records updated to point to server
# [ ] Firewall rules configured
# [ ] Backup storage configured
# [ ] Monitoring alerts configured
# [ ] File permissions set to 600
# [ ] Regular security audits scheduled
#
# =============================================================================